-- This script was generated by the ERD tool in pgAdmin 4.
-- Please log an issue at https://github.com/pgadmin-org/pgadmin4/issues/new/choose if you find any bugs, including reproduction steps.
BEGIN;


ALTER TABLE IF EXISTS public.order_items DROP CONSTRAINT IF EXISTS fk_order_items_order_id;

ALTER TABLE IF EXISTS public.order_items DROP CONSTRAINT IF EXISTS fk_order_items_product_id;

ALTER TABLE IF EXISTS public.orders DROP CONSTRAINT IF EXISTS fk_orders_customer_id;



DROP TABLE IF EXISTS public.categories;

CREATE TABLE IF NOT EXISTS public.categories
(
    id integer NOT NULL,
    name character varying COLLATE pg_catalog."default" NOT NULL,
    CONSTRAINT name_pkey PRIMARY KEY (id)
);

DROP TABLE IF EXISTS public.customers;

CREATE TABLE IF NOT EXISTS public.customers
(
    id integer NOT NULL,
    name character varying(100) COLLATE pg_catalog."default" NOT NULL,
    email character varying(100) COLLATE pg_catalog."default" NOT NULL,
    address character varying(200) COLLATE pg_catalog."default",
    CONSTRAINT customers_pkey PRIMARY KEY (id)
);

DROP TABLE IF EXISTS public.order_items;

CREATE TABLE IF NOT EXISTS public.order_items
(
    id integer NOT NULL,
    order_id integer NOT NULL,
    product_id integer NOT NULL,
    quantity integer NOT NULL,
    CONSTRAINT order_items_pkey PRIMARY KEY (id)
);

DROP TABLE IF EXISTS public.orders;

CREATE TABLE IF NOT EXISTS public.orders
(
    id integer NOT NULL,
    customer_id integer NOT NULL,
    order_date date NOT NULL,
    CONSTRAINT orders_pkey PRIMARY KEY (id)
);

DROP TABLE IF EXISTS public.products;

CREATE TABLE IF NOT EXISTS public.products
(
    id integer NOT NULL,
    name character varying(100) COLLATE pg_catalog."default" NOT NULL,
    category_id integer NOT NULL,
    cost_price double precision NOT NULL,
    selling_price double precision NOT NULL,
    CONSTRAINT product_pkey PRIMARY KEY (id)
);

ALTER TABLE IF EXISTS public.order_items
    ADD CONSTRAINT fk_order_items_order_id FOREIGN KEY (order_id)
    REFERENCES public.orders (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;

COMMENT ON CONSTRAINT fk_order_items_order_id ON public.order_items
    IS 'fk_order_items_order_id';



ALTER TABLE IF EXISTS public.order_items
    ADD CONSTRAINT fk_order_items_product_id FOREIGN KEY (product_id)
    REFERENCES public.products (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.orders
    ADD CONSTRAINT fk_orders_customer_id FOREIGN KEY (customer_id)
    REFERENCES public.customers (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;

COMMENT ON CONSTRAINT fk_orders_customer_id ON public.orders
    IS 'fk_orders_customer_id';

INSERT INTO public.customers(id, name, email, address)VALUES (1,"ajay","ajay@gmail.com","pune"),(2,"vijay","vijay@gmail.com","pune"),(3,"sujay","sujay@gmail.com","pune");
INSERT INTO public.categories(id, name)VALUES (1,"Shoes"),(2,"Electronics"),(3,"Clothing");
INSERT INTO public.products(id, name, category_id, cost_price, selling_price)VALUES (1,'UltraBoost Running Shoes',1,'1000','1100'),(2,'iPhone 15 Pro,Electronics',2,'11000','11100'),(3,'Levis 501 Jeans',3,'500','550')
INSERT INTO public.orders(id, customer_id, order_date)VALUES (1,1,'2025-05-14'),(2,1,'2025-05-13'),(3,1,'2025-05-15'),(4,2,'2025-05-15'),(5,2,'2025-05-14');
INSERT INTO public.order_items(id, order_id, product_id, quantity)VALUES (1,1,1,10),(2,2,1,10),(3,3,1,10),(4,4,1,10),(5,5,1,10);

END;